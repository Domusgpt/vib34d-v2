<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIB34D System Test</title>
    <style>
        body { font-family: 'Courier New', monospace; background: #000; color: #00ff00; padding: 20px; }
        .test-section { margin: 20px 0; padding: 15px; border: 1px solid #00ff00; border-radius: 5px; }
        .pass { color: #00ff00; }
        .fail { color: #ff0000; }
        .info { color: #ffff00; }
        iframe { width: 100%; height: 300px; border: 1px solid #00ff00; margin: 10px 0; }
        button { background: #000; color: #00ff00; border: 1px solid #00ff00; padding: 10px; margin: 5px; cursor: pointer; }
        button:hover { background: #00ff00; color: #000; }
    </style>
</head>
<body>
    <h1>üß™ VIB34D System Functionality Test</h1>
    
    <div class="test-section">
        <h2>Test 1: Main Interface Loading</h2>
        <button onclick="testMainInterface()">Test Main Interface</button>
        <div id="mainTest">Click button to test...</div>
    </div>
    
    <div class="test-section">
        <h2>Test 2: Gallery System</h2>
        <button onclick="testGallery()">Test Gallery</button>
        <div id="galleryTest">Click button to test...</div>
    </div>
    
    <div class="test-section">
        <h2>Test 3: System Parameter Test</h2>
        <button onclick="testSystemParams()">Test Different Systems</button>
        <div id="paramTest">Click button to test...</div>
    </div>
    
    <div class="test-section">
        <h2>Test 4: Gallery Preview Test</h2>
        <p class="info">Testing gallery previews for different systems:</p>
        
        <h3>Faceted System Preview:</h3>
        <iframe src="index.html?system=faceted&hideui=true&geometry=1&hue=180&gridDensity=25" id="facetedPreview"></iframe>
        
        <h3>Quantum System Preview:</h3>
        <iframe src="index.html?system=quantum&hideui=true&geometry=2&hue=250&gridDensity=30" id="quantumPreview"></iframe>
        
        <h3>Holographic System Preview:</h3>
        <iframe src="index.html?system=holographic&hideui=true&geometry=3&hue=320&gridDensity=35" id="holographicPreview"></iframe>
    </div>
    
    <div class="test-section">
        <h2>Test Results Summary</h2>
        <div id="testResults">
            <p class="info">Run tests above to see results...</p>
        </div>
    </div>

    <script>
        let testResults = {};
        
        function updateResults() {
            const resultsDiv = document.getElementById('testResults');
            let html = '<h3>Test Results:</h3>';
            
            for (const [test, result] of Object.entries(testResults)) {
                const status = result.success ? 'PASS' : 'FAIL';
                const className = result.success ? 'pass' : 'fail';
                html += `<p class="${className}">‚Ä¢ ${test}: ${status} - ${result.message}</p>`;
            }
            
            resultsDiv.innerHTML = html;
        }
        
        function testMainInterface() {
            const testDiv = document.getElementById('mainTest');
            testDiv.innerHTML = '<p class="info">Testing main interface loading...</p>';
            
            // Test if main interface can be loaded
            const testFrame = document.createElement('iframe');
            testFrame.style.display = 'none';
            testFrame.onload = function() {
                try {
                    // Check if basic elements exist
                    const frameDoc = testFrame.contentDocument || testFrame.contentWindow.document;
                    const hasCanvas = frameDoc.getElementById('vib34dLayers') !== null;
                    const hasControls = frameDoc.querySelector('.control-panel') !== null;
                    const hasSystemButtons = frameDoc.querySelectorAll('.system-btn').length >= 4;
                    
                    if (hasCanvas && hasControls && hasSystemButtons) {
                        testDiv.innerHTML = '<p class="pass">‚úÖ Main interface loaded successfully!</p>';
                        testResults.mainInterface = { success: true, message: 'All core elements present' };
                    } else {
                        testDiv.innerHTML = '<p class="fail">‚ùå Main interface missing core elements</p>';
                        testResults.mainInterface = { success: false, message: 'Missing canvas or controls' };
                    }
                } catch (error) {
                    testDiv.innerHTML = '<p class="fail">‚ùå Main interface test failed: ' + error.message + '</p>';
                    testResults.mainInterface = { success: false, message: 'Load error: ' + error.message };
                }
                updateResults();
                document.body.removeChild(testFrame);
            };
            
            testFrame.onerror = function() {
                testDiv.innerHTML = '<p class="fail">‚ùå Main interface failed to load</p>';
                testResults.mainInterface = { success: false, message: 'Failed to load index.html' };
                updateResults();
                document.body.removeChild(testFrame);
            };
            
            testFrame.src = 'index.html';
            document.body.appendChild(testFrame);
        }
        
        function testGallery() {
            const testDiv = document.getElementById('galleryTest');
            testDiv.innerHTML = '<p class="info">Testing gallery loading...</p>';
            
            const testFrame = document.createElement('iframe');
            testFrame.style.display = 'none';
            testFrame.onload = function() {
                try {
                    const frameDoc = testFrame.contentDocument || testFrame.contentWindow.document;
                    const hasHeader = frameDoc.querySelector('.header') !== null;
                    const hasContainer = frameDoc.getElementById('collectionsContainer') !== null;
                    const hasHolographicEffects = frameDoc.querySelector('script').textContent.includes('holographic');
                    
                    if (hasHeader && hasContainer) {
                        testDiv.innerHTML = '<p class="pass">‚úÖ Gallery loaded successfully!</p>';
                        testResults.gallery = { success: true, message: 'Gallery structure complete' };
                    } else {
                        testDiv.innerHTML = '<p class="fail">‚ùå Gallery missing core elements</p>';
                        testResults.gallery = { success: false, message: 'Missing header or container' };
                    }
                } catch (error) {
                    testDiv.innerHTML = '<p class="fail">‚ùå Gallery test failed: ' + error.message + '</p>';
                    testResults.gallery = { success: false, message: 'Error: ' + error.message };
                }
                updateResults();
                document.body.removeChild(testFrame);
            };
            
            testFrame.src = 'gallery.html';
            document.body.appendChild(testFrame);
        }
        
        function testSystemParams() {
            const testDiv = document.getElementById('paramTest');
            testDiv.innerHTML = '<p class="info">Testing system parameter URLs...</p>';
            
            const systems = ['faceted', 'quantum', 'holographic', 'polychora'];
            let testedSystems = 0;
            let workingSystems = 0;
            
            systems.forEach(system => {
                const testFrame = document.createElement('iframe');
                testFrame.style.display = 'none';
                testFrame.onload = function() {
                    testedSystems++;
                    try {
                        // Just check if the frame loads without errors
                        workingSystems++;
                    } catch (error) {
                        // Frame had errors
                    }
                    
                    if (testedSystems === systems.length) {
                        if (workingSystems === systems.length) {
                            testDiv.innerHTML = `<p class="pass">‚úÖ All ${workingSystems}/${systems.length} systems working!</p>`;
                            testResults.systemParams = { success: true, message: `All ${workingSystems} systems respond to parameters` };
                        } else {
                            testDiv.innerHTML = `<p class="fail">‚ùå Only ${workingSystems}/${systems.length} systems working</p>`;
                            testResults.systemParams = { success: false, message: `Only ${workingSystems}/${systems.length} systems working` };
                        }
                        updateResults();
                    }
                    document.body.removeChild(testFrame);
                };
                
                testFrame.src = `index.html?system=${system}&hideui=true&geometry=1&hue=180`;
                document.body.appendChild(testFrame);
            });
        }
        
        // Monitor iframe loading for preview test
        setTimeout(() => {
            const iframes = ['facetedPreview', 'quantumPreview', 'holographicPreview'];
            let loadedIframes = 0;
            
            iframes.forEach(id => {
                const iframe = document.getElementById(id);
                iframe.onload = function() {
                    loadedIframes++;
                    if (loadedIframes === iframes.length) {
                        testResults.galleryPreview = { 
                            success: true, 
                            message: `All ${loadedIframes} preview iframes loaded successfully` 
                        };
                        updateResults();
                    }
                };
                
                iframe.onerror = function() {
                    testResults.galleryPreview = { 
                        success: false, 
                        message: `Preview iframe ${id} failed to load` 
                    };
                    updateResults();
                };
            });
        }, 1000);
        
        console.log('üß™ VIB34D Browser Test Suite initialized');
        console.log('Click the test buttons to verify functionality');
    </script>
</body>
</html>